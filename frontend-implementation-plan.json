{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Add fullscreen button to fill screen with user-chosen background",
  "requirements": [
    {
      "id": "REQ-1",
      "summary": "Add a fullscreen button that toggles the browser's Fullscreen API on the background stage element, filling the entire screen with the user's active background (image, video, or YouTube), with appropriate icon/label updates and visibility only when a background is active",
      "acceptanceCriteria": [
        "A fullscreen button is visible in the UI when a background (image, video, or YouTube) is active.",
        "Clicking the fullscreen button causes the browser to enter fullscreen mode, displaying only the user's chosen background filling the entire screen.",
        "While in fullscreen mode, the button changes to indicate 'exit fullscreen' functionality.",
        "Clicking the button again (or pressing Escape) exits fullscreen and returns to the normal app layout.",
        "The button is not shown when no background is active.",
        "Works correctly for all background types: image, video, and YouTube embed."
      ],
      "file_operations": [
        {
          "path": "frontend/src/features/backgrounds/BackgroundFullscreenButton.tsx",
          "operation": "create",
          "description": "Create a new component that renders a fixed/floating fullscreen toggle button. The button should only render when a background is active (using the background context). Use the browser's Fullscreen API (requestFullscreen/exitFullscreen) on the background stage element reference. Track fullscreen state using the 'fullscreenchange' event listener to update the button icon/label between 'Enter Fullscreen' and 'Exit Fullscreen' states. Position the button fixed in the UI (e.g., top-right or bottom-right) and style it consistently with existing UI patterns."
        },
        {
          "path": "frontend/src/features/backgrounds/useBackground.ts",
          "operation": "modify",
          "description": "Extend the useBackground hook to expose a ref for the background stage element that will be used by the fullscreen button component to call requestFullscreen(). Add this ref to the hook's return value so it can be passed down through the BackgroundProvider context."
        },
        {
          "path": "frontend/src/features/backgrounds/BackgroundProvider.tsx",
          "operation": "modify",
          "description": "Update the BackgroundProvider to expose the background stage element ref from useBackground through the context, making it available to child components including the new BackgroundFullscreenButton."
        },
        {
          "path": "frontend/src/features/backgrounds/BackgroundStage.tsx",
          "operation": "modify",
          "description": "Attach the background stage element ref (from useBackground) to the root container div that wraps the background rendering logic, so the fullscreen button can target this element when invoking the Fullscreen API."
        },
        {
          "path": "frontend/src/App.tsx",
          "operation": "modify",
          "description": "Import and render the new BackgroundFullscreenButton component inside the BackgroundProvider scope, positioned appropriately in the layout so it appears fixed/floating in the UI when a background is active. Ensure it is rendered after BackgroundStage so it appears above the background layer."
        }
      ]
    }
  ]
}